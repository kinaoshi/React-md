### Usersの子ページに"投稿"と"コメント"を追加する
#### 投稿を追加
> User/index.jsxのページの
```js
<div>
    <h1>{data.name}</h1>
     <ul>
      <li>{data.id}</li>
            <li>{data.email}</li>
      <li>{data.username}</li>
        <li>{data.phone}</li>
      <li>{data.website}</li>
      <li>{data.company.name}</li>
    </ul>
</div>
```
>  を
```js
<div>
    <h1>{data.name}</h1>
    <h2>詳細</h2>
     <ul>
      <li>{data.id}</li>
            <li>{data.email}</li>
      <li>{data.username}</li>
        <li>{data.phone}</li>
      <li>{data.website}</li>
      <li>{data.company.name}</li>
    </ul>
  <h2>投稿</h2>
  <h2>コメント</h2>
</div>
```
> とする
- PostsフォルダにPostsByUserId.jsxを追加
- - そこにPosts/index.jsxを全てコピーして貼り付ける
- - export const Posts = () => {部分を
- - export const PostsByUserId = () => {に変更
> PostsByUserId.jsxのusePosts();から呼び出し元に飛ぶ
- useFetchArray.jsxに飛んでくるので、ここの最下段に
```js
export const usePostsByUserId = (id) => {
 return useFetchArray(id? `${API_URL}/posts?userId=${id}`:null);
}
```
> を追加する
- PostsByUserId.jsx の
```js
export const PostsByUserId = () => {
  const { data, error, isLoading, isEmpty } = usePosts();
```
> のusePosts();をusePostsByUserId();に変更
> importも変更しておく
> 引数をprops.idとして
```js
export const PostsByUserId = (props) => {
  const { data, error, isLoading, isEmpty } = usePostsByUserId(props.id);
```
> とする
- これをUser/index.jsxで呼び出す
```js
<h2>投稿</h2>
<PostsByUserId id={data.id}/>
```
---
> ここまでをコミット
- ✨ ユーザーページに投稿一覧を追加
---
#### コメントを追加
> CommentsByPostId.jsxをコピー
> 同じ場所にCommentsByUserId.jsxフォルダを作り、貼り付ける
```js
export const CommentsByPostId = (props) => {
```
> を
```js
export const CommentsByUserId = (props) => {
  const { data, error, isLoading, isEmpty } = useCommentsByPostsId(props.id);
```
> に変更
---
> ここまできて、コメントの追加ができないことが判明。そもそも宿題として成立していなかったらしい。
> 今作ったCommentsByUserId.jsxフォルダを削除
```js
export const CommentsByUserId = (props) => {
  const { data, error, isLoading, isEmpty } = useCommentsByPostsId(props.id);
```
> の部分も削除
> User/index.jsxの＜h2＞コメント＜/h2＞も削除
- コミット
- 🔥 不要になったコードを削除
---
### Commentsの元の記事を取得して表示する
> Comment/index.jsxに Userと同じように＜h2＞元の記事＜/h2＞を追加
- PostフォルダにPostByCommentId.jsxを作成し、Post/index.jsxをコピーして貼り付ける
> export const Post = () => {を
> export const PostByCommentId = () => {に変更
- hooksにusePostByCommentId.jsxを作成してusePost.jsxを全コピーして貼り付け
---
> usePostByCommentId.jsxを作ったが、usePost.jsxを利用して、元の記事が取得できるのでその方法でやるので今作ったばかりのusePostByCommentId.jsxは削除する
- hooks/usePost.jsx内の
- - export const usePost = () => {の部分を
- - export const usePost = (props) => {として
> 最終的に
```js
import useSWR from "swr";
export const usePost = (id) => {
  const { data, error } = useSWR(
    id
      ? `https://jsonplaceholder.typicode.com/posts/${id}`
      : null
  );
  return {
    data,
    error,
    isLoading: !data && !error,
  };
};
```
> となる。
> usePostを呼び出しているところを変更する必要があるので、
> Post/index.jsxで
- const {data, error, isLoading } = usePost();を
- const {data, error, isLoading } = usePost(router.query.id);に変更
---
> コミット
- 🎨 投稿取得まわりのアーキテクチャが少し変更
---
> ここまでで、hooks/usePost.jsxのusePostが汎用的に使えるようになったのでこれをPosts/PostsByUserId.jsxで使えばOK
> export const PostByCommentId = () => {
const {data, error, isLoading } = usePost();の部分を
- export const PostByCommentId = (props) => {
- const {data, error, isLoading } = usePost(props.id)
> とする
- これをcomment/index.jsxで呼び出す
```js
<h2>元の記事</h2>
<PostByCommentId id={data.postId}/>
```
> と記載する。記事がだぶっているので
- Post/PostByCommentId.jsxの
```js
  <Head>
        <title>{data?.title}</title>
  </Head>
  <p>{data?.body}</p>
  <UserByUserId id={data.userId} />      <CommentsByPostId id={data.id} />
  <div></div>
```
> は削除する
#### 元の記事に飛べるようにする
> return <p>{data?.title}</p>;の部分を
```js
return (
    <Link href={`/posts/${data?.id}`}>
      <a>{data?.title}</a>
    </Link>
    );
```
> とすることで、元の記事一覧に飛べるようになった
---
> コミット
- ✨ コメントページで元の投稿を表示
---
> リファクタリング
- useFetchArray
- useCommentsByPostsIdをuseCommentsByPostIdに変更
- - comments/CommentsByPostId.jsx内も同じように変更
```js
//  users

 export const useUsers = () => {
   return useFetchArray(`${API_URL}/users`);
 };

//  comments

export const useComments = () => {
  return useFetchArray(`${API_URL}/comments`);
};


export const useCommentsByPostId = (id) => {
 return useFetchArray(id? `${API_URL}/comments?postId=${id}`:null);
}
```
- 🚚 英語の間違い修正、複数形を単数形に
---



