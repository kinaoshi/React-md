## éåŒæœŸå‡¦ç†ã§å¿…è¦ã«ãªã‚‹ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã¨ã‚¨ãƒ©ãƒ¼ã®å‡¦ç†

- å¤–éƒ¨ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ä½¿ã‚ãšã€åŸºæœ¬å½¢ã§è¨˜è¿°ã—ã¦ã¿ã‚‹
- ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ç”¨ã¨ã‚¨ãƒ©ãƒ¼ç”¨ã® useState ã‚’ç”¨æ„ã—ã¦ã€getPosts();ã®ä¸­ã§ setLoading ã—ã¦ã€ãã“ã§çŠ¶æ…‹ã‚’å¤‰ãˆã¦ã„ã
- return æ–‡ã®ä¸­ã§ã€ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã¨ã‚¨ãƒ©ãƒ¼ã®éš›ã®è¡¨ç¤ºã•ã›ã‚‹

### ã¾ãšã¯ã€ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‹ã‚‰
> const [posts, setPosts] = useState([]);ã®æ¬¡ã«
```js
const [loading, setLoading] = useState(true);
```

> ã¨å¼•æ•°ã‚’ true ã«ã—ã¦ã€ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚’è¡¨ç¤ºã•ã›ã‚‹

```js
{
  post.length > 0 ? (
    <ol>
      {posts.map((post) => {
        return <li key={post.id}>{post.title}</li>;
      })}
    </ol>
  ) : null
}
```

ã®éƒ¨åˆ†ã‚’

```js
{
  loading ? (
    <div>ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ä¸­</div>
  ) : posts.length > 0 ? (
    <ol>
      {posts.map((post) => {
        return <li key={post.id}>{post.title}</li>;
      })}
    </ol>
  ) : null
}
```

- ã¨ã™ã‚‹ã¨ã€ãƒ–ãƒ©ã‚¦ã‚¶ã«"ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ä¸­"ãŒè¡¨ç¤ºã•ã‚Œã‚‹
  > æ¬¡ã«ã€API ã‚’å–å¾—ã—ãŸå¾Œã¯ã€false ã«ã—ãŸã„ã®ã§

```js
setPosts(json);
```

> ã®ä¸‹ã«ã€

```js
setLoading(false);
```

> ã¨è¨˜è¿°ã™ã‚‹ã€‚
> ã“ã“ã¾ã§ã®è¨˜è¿°ã§ã¯ã€ãƒ‡ãƒ¼ã‚¿ãŒãªã„æ™‚ã«ã¯ null ã§ä½•ã‚‚è¡¨ç¤ºã•ã‚Œãªã„ã®ã§ã€
> ãƒ‡ãƒ¼ã‚¿ãŒãªã„ã¨ãã¯ã€ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“ã¨è¡¨ç¤ºã•ã‚Œã‚‹ã‚ˆã†ã«ã™ã‚‹

- null ã®ã¨ã“ã‚ã‚’æ¬¡ã«æ›¸ãæ›ãˆã‚‹

```js
<div>ãƒ‡ãƒ¼ã‚¿ã¯ç©ºã§ã™</div>
```

### æ¬¡ã¯ã‚¨ãƒ©ãƒ¼çŠ¶æ…‹ã®è¡¨ç¤º

```js
const [loading, setLoading] = useState(true);
```

> ã®ä¸‹ã«

```js
const [error, setError] = useState(null);
```

> ã‚’è¨˜è¿°ã€‚
> æ¬¡ã«ã€éåŒæœŸå‡¦ç†ãªã®ã§ã‚ˆãè¡Œã‚ã‚Œã‚‹ãƒˆãƒ©ã‚¤ã€ã‚­ãƒ£ãƒƒãƒæ–‡ã§ã‚¨ãƒ©ãƒ¼ã®ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã‚’è¡Œã†ã€‚
- const getPosts = useCallback(async () => {ã®æ¬¡ã«
```js
try {
  const res = await fetch("https://jsonplaceholder.typicode.com/posts");

  const json = await res.json();
  setPosts(json);
} catch (error) {
  setError(error);
}
setLoading(false);
```

> ã¨è¨˜è¿°ã™ã‚‹ã¨ã€ãƒ‡ãƒ¼ã‚¿ãŒå–å¾—ã§ããªã‹ã£ãŸæ™‚ã«ã‚‚"ãƒ‡ãƒ¼ã‚¿ã¯ç©º"ã¨è¡¨ç¤ºã•ã‚Œã‚‹ã®ã§ã€å–å¾—ã§ããªã‹ã£ãŸã¨ãã¯ã€"ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸãŸã‚ã€ãƒ‡ãƒ¼ã‚¿ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸã€‚"ã¨è¡¨ç¤ºã•ã›ã‚‹ã‚ˆã†ã«è¨˜è¿°ã™ã‚‹ã€‚

```js
try {
  const res = await fetch("https://jsonplaceholder.typicode.com/posts");
  if (!res.ok) {
    throw new Error("ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸãŸã‚ã€ãƒ‡ãƒ¼ã‚¿ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸã€‚");
  }
  const json = await res.json();
  setPosts(json);
} catch (error) {
  setError(error);
}
```

> ã“ã‚Œã§ã€setError(error);ã® error ã®ãªã‹ã«ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒå…¥ã£ã¦ã„ã‚‹ã®ã§ã€ã“ã‚Œã‚’ãƒªã‚¿ãƒ¼ãƒ³æ–‡ã§è¡¨ç¤ºã•ã›ã‚‹ã€‚

```js
return (
  {loading ? (
    <div>ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ä¸­</div>
  ) : error ? (
    <div>{error.message}</div>
  ) : posts.length > 0 ? (
  <ol>
    {posts.map((post) => {
      return <li key={post.id}>{post.title}</li>;
    })}
  </ol>
  ) : (
    <div>ãƒ‡ãƒ¼ã‚¿ã¯ç©ºã§ã™</div>
  )}

);
```

> ã¨ã™ã‚‹ã“ã¨ã§ã€ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤ºã§ãã‚‹ã€‚

### ã“ã“ã¾ã§ã®è¨˜è¿°ã‚’ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã«ã¾ã¨ã‚ã‚‹ã€‚

- component ãƒ•ã‚©ãƒ«ãƒ€ã®ä¸‹å±¤ã« Posts ãƒ•ã‚©ãƒ«ãƒ€ã‚’ä½œæˆ
- ãã®ä¸­ã«ã€index.jsx ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ
- pages å†…ã® index.jsx ã‚’ã‚³ãƒ”ãƒ¼ã—ã¦ã€Posts ã® index.jsx ã«ãƒšãƒ¼ã‚¹ãƒˆ
- ä¸å¿…è¦ãªéƒ¨åˆ†ã‚’å‰Šé™¤ã™ã‚‹ã¨

```js
import { useCallback, useEffect, useState } from "react";

export const Posts = () => {
  const [posts, setPosts] = useState([]);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState(null);

  const getPosts = useCallback(async () => {
    try {
      const res = await fetch("https://jsonplaceholder.typicode.com/posts");
      if (!res.ok) {
        throw new Error("ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸãŸã‚ã€ãƒ‡ãƒ¼ã‚¿ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸã€‚");
      }
      const json = await res.json();
      setPosts(json);
    } catch (error) {
      setError(error);
    }
    setLoading(false);
  }, []);
  useEffect(() => {
    getPosts();
  }, [getPosts]);
  return (
    <div>
      {loading ? (
        <div>ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ä¸­</div>
      ) : error ? (
        <div>{error.message}</div>
      ) : posts.length > 0 ? (
        <ol>
          {posts.map((post) => {
            return <li key={post.id}>{post.title}</li>;
          })}
        </ol>
      ) : (
        <div>ãƒ‡ãƒ¼ã‚¿ã¯ç©ºã§ã™</div>
      )}
    </div>
  );
};
```

> return æ–‡ãŒå†—é•·ãªã®ã§ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°

```js
useEffect(() => {
  getPosts();
}, [getPosts]);
if (loading) {
  return <div>ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ä¸­</div>;
}
if (error) {
  return <div>{error.message}</div>;
}
if (posts.length === 0) {
  return <div>ãƒ‡ãƒ¼ã‚¿ã¯ç©ºã§ã™</div>;
}

return (
  <ol>
    {posts.map((post) => {
      return <li key={post.id}>{post.title}</li>;
    })}
  </ol>
);
```
> pages/index.jsxã¯
```js
import Head from "next/head";
import { Header } from "src/components/Header";
import { Posts } from "src/components/Posts";
import styles from "src/styles/Home.module.css";

const Home = () => {


  return (
    <div className={styles.container}>
      <Head>
        <title>Create Next App</title>
      </Head>
      <Header />
      <Posts/>
    </div>
  );
};

export default Home;
```
> ã¨ãªã‚‹
---
- ã‚³ãƒŸãƒƒãƒˆ
  - ğŸš¸APIã‚’å©ãéš›ã®ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°çŠ¶æ…‹ã‚¨ãƒ©ãƒ¼çŠ¶æ…‹ã®ç®¡ç†
